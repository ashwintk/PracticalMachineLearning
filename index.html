<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Practicalmachinelearning by ashwintk</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Practicalmachinelearning</h1>
      <h2 class="project-tagline"></h2>
      <a href="https://github.com/ashwintk/PracticalMachineLearning" class="btn">View on GitHub</a>
      <a href="https://github.com/ashwintk/PracticalMachineLearning/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/ashwintk/PracticalMachineLearning/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <p></p>

<p></p>

<p>

</p>

<p></p>



<p>
</p>







code{white-space: pre;}

<p></p>




  pre:not([class]) {
    background-color: white;
  }




<p></p>

<p></p>


.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img { 
  max-width:100%; 
  height: auto; 
}


<div>




<hr>
<div id="machine-learning-course-project">
<h1>
<a id="machine-learning-course-project" class="anchor" href="#machine-learning-course-project" aria-hidden="true"><span class="octicon octicon-link"></span></a>Machine Learning Course Project</h1>
<div id="author-ashwin-kumar">
<h2>
<a id="author-ashwin-kumar" class="anchor" href="#author-ashwin-kumar" aria-hidden="true"><span class="octicon octicon-link"></span></a>Author: Ashwin Kumar</h2>
<div id="load-all-the-required-libraries">
<h3>
<a id="1-load-all-the-required-libraries" class="anchor" href="#1-load-all-the-required-libraries" aria-hidden="true"><span class="octicon octicon-link"></span></a>1. Load all the required libraries</h3>
<pre><code>library(caret)
library(reshape2)
library(ggplot2)
library(rattle)
library(rpart)
set.seed(123456789)</code></pre>
</div>

<div id="fetch-the-given-dataset">
<h3>
<a id="2-fetch-the-given-dataset" class="anchor" href="#2-fetch-the-given-dataset" aria-hidden="true"><span class="octicon octicon-link"></span></a>2. Fetch the given dataset</h3>
<pre><code>downloadData &lt;- function(URL, fileName){
  #Download the required file
  download.file(url = URL,destfile = fileName,method = "curl")
  #Mark the fields that are NA's properly
  process_na &lt;- read.csv(fileName,na.strings=c("NA","#Div/0!",""))
  process_na
}
total_train &lt;- downloadData(URL="https://d396qusza40orc.cloudfront.net/predmachlearn/pml-training.csv",fileName="train.csv")
total_test &lt;- downloadData(URL="https://d396qusza40orc.cloudfront.net/predmachlearn/pml-testing.csv",fileName="test.csv")</code></pre>
</div>

<div id="preprocess-the-fetched-dataset">
<h3>
<a id="3-preprocess-the-fetched-dataset" class="anchor" href="#3-preprocess-the-fetched-dataset" aria-hidden="true"><span class="octicon octicon-link"></span></a>3. Preprocess the fetched dataset</h3>
<p>For my analysis, I will be partitioning my training set into two (train and test set). I will retain the test dataset to identify a machine learning algorithm that performs the best</p>
<pre><code>inTrain &lt;- createDataPartition(y = total_train$classe, p = 0.7,list=FALSE)
myTrain &lt;- total_train[inTrain,]
myTest &lt;- total_train[-inTrain,]
dim(myTrain)</code></pre>
<pre><code>## [1] 13737   160</code></pre>
<p>In the next step in pre-processing the dataset, I will have to identify the fields that show no variablility. I have done this using nearZeroVar function</p>
<pre><code>nearZeroMetrics &lt;- nearZeroVar(myTrain,saveMetrics = TRUE)
nearZeroMetrics</code></pre>
<pre><code>##                          freqRatio percentUnique zeroVar   nzv
## X                         1.000000  100.00000000   FALSE FALSE
## user_name                 1.095567    0.04367766   FALSE FALSE
## raw_timestamp_part_1      1.035714    6.09303341   FALSE FALSE
## raw_timestamp_part_2      1.000000   89.27713475   FALSE FALSE
## cvtd_timestamp            1.019084    0.14559220   FALSE FALSE
## new_window               45.252525    0.01455922   FALSE  TRUE
## num_window                1.035714    6.24590522   FALSE FALSE
## roll_belt                 1.116883    7.97845235   FALSE FALSE
## pitch_belt                1.206612   12.28070175   FALSE FALSE
## yaw_belt                  1.093664   12.87762976   FALSE FALSE
## total_accel_belt          1.077580    0.20382907   FALSE FALSE
## kurtosis_roll_belt       10.000000    2.09652763   FALSE FALSE
## kurtosis_picth_belt       8.000000    1.78350440   FALSE FALSE
## kurtosis_yaw_belt         0.000000    0.00727961    TRUE  TRUE
## skewness_roll_belt        4.500000    2.09652763   FALSE FALSE
## skewness_roll_belt.1      8.000000    1.86358011   FALSE FALSE
## skewness_yaw_belt         0.000000    0.00727961    TRUE  TRUE
## max_roll_belt             1.222222    1.20113562   FALSE FALSE
## max_picth_belt            2.051282    0.14559220   FALSE FALSE
## max_yaw_belt              1.100000    0.42221737   FALSE FALSE
## min_roll_belt             1.000000    1.11378030   FALSE FALSE
## min_pitch_belt            2.540541    0.10191454   FALSE FALSE
## min_yaw_belt              1.100000    0.42221737   FALSE FALSE
## amplitude_roll_belt       1.260870    0.88083279   FALSE FALSE
## amplitude_pitch_belt      2.867925    0.09463493   FALSE FALSE
## amplitude_yaw_belt       28.000000    0.02183883   FALSE  TRUE
## var_total_accel_belt      1.354839    0.39309893   FALSE FALSE
## avg_roll_belt             1.083333    1.16473757   FALSE FALSE
## stddev_roll_belt          1.051282    0.42949698   FALSE FALSE
## var_roll_belt             1.500000    0.54597074   FALSE FALSE
## avg_pitch_belt            1.142857    1.28849094   FALSE FALSE
## stddev_pitch_belt         1.100000    0.26206595   FALSE FALSE
## var_pitch_belt            1.106667    0.37126010   FALSE FALSE
## avg_yaw_belt              1.250000    1.42680352   FALSE FALSE
## stddev_yaw_belt           1.676471    0.35670088   FALSE FALSE
## var_yaw_belt              1.777778    0.90267162   FALSE FALSE
## gyros_belt_x              1.049163    0.92451045   FALSE FALSE
## gyros_belt_y              1.160083    0.47317464   FALSE FALSE
## gyros_belt_z              1.063149    1.15745796   FALSE FALSE
## accel_belt_x              1.052441    1.17201718   FALSE FALSE
## accel_belt_y              1.093151    0.99002693   FALSE FALSE
## accel_belt_z              1.084437    2.12564607   FALSE FALSE
## magnet_belt_x             1.007663    2.22028099   FALSE FALSE
## magnet_belt_y             1.115556    2.11836646   FALSE FALSE
## magnet_belt_z             1.058462    3.20302832   FALSE FALSE
## roll_arm                 52.434783   17.46378394   FALSE FALSE
## pitch_arm                86.178571   20.06260464   FALSE FALSE
## yaw_arm                  32.160000   19.22544952   FALSE FALSE
## total_accel_arm           1.015974    0.48045425   FALSE FALSE
## var_accel_arm             4.000000    2.10380724   FALSE FALSE
## avg_roll_arm             51.000000    1.79806362   FALSE  TRUE
## stddev_roll_arm          51.000000    1.79806362   FALSE  TRUE
## var_roll_arm             51.000000    1.79806362   FALSE  TRUE
## avg_pitch_arm            51.000000    1.79806362   FALSE  TRUE
## stddev_pitch_arm         51.000000    1.79806362   FALSE  TRUE
## var_pitch_arm            51.000000    1.79806362   FALSE  TRUE
## avg_yaw_arm              51.000000    1.79806362   FALSE  TRUE
## stddev_yaw_arm           53.000000    1.78350440   FALSE  TRUE
## var_yaw_arm              53.000000    1.78350440   FALSE  TRUE
## gyros_arm_x               1.000000    4.50607847   FALSE FALSE
## gyros_arm_y               1.392573    2.68617602   FALSE FALSE
## gyros_arm_z               1.150273    1.71070831   FALSE FALSE
## accel_arm_x               1.173554    5.61257917   FALSE FALSE
## accel_arm_y               1.056604    3.82907476   FALSE FALSE
## accel_arm_z               1.098901    5.59801995   FALSE FALSE
## magnet_arm_x              1.050000    9.65276261   FALSE FALSE
## magnet_arm_y              1.046154    6.26046444   FALSE FALSE
## magnet_arm_z              1.103896    9.14318993   FALSE FALSE
## kurtosis_roll_arm        52.000000    1.79078401   FALSE  TRUE
## kurtosis_picth_arm       53.000000    1.78350440   FALSE  TRUE
## kurtosis_yaw_arm          4.000000    2.09652763   FALSE FALSE
## skewness_roll_arm        51.000000    1.79806362   FALSE  TRUE
## skewness_pitch_arm       53.000000    1.78350440   FALSE  TRUE
## skewness_yaw_arm          4.000000    2.10380724   FALSE FALSE
## max_roll_arm             17.000000    1.57967533   FALSE FALSE
## max_picth_arm            17.000000    1.50687923   FALSE FALSE
## max_yaw_arm               1.333333    0.34214166   FALSE FALSE
## min_roll_arm             17.000000    1.57967533   FALSE FALSE
## min_pitch_arm            17.000000    1.63791221   FALSE FALSE
## min_yaw_arm               1.052632    0.26206595   FALSE FALSE
## amplitude_roll_arm       25.500000    1.70342870   FALSE  TRUE
## amplitude_pitch_arm      17.666667    1.65247143   FALSE FALSE
## amplitude_yaw_arm         1.263158    0.35670088   FALSE FALSE
## roll_dumbbell             1.010526   86.68559365   FALSE FALSE
## pitch_dumbbell            2.294737   84.62546408   FALSE FALSE
## yaw_dumbbell              1.172840   86.11778409   FALSE FALSE
## kurtosis_roll_dumbbell    1.500000    2.11836646   FALSE FALSE
## kurtosis_picth_dumbbell   1.000000    2.12564607   FALSE FALSE
## kurtosis_yaw_dumbbell     0.000000    0.00727961    TRUE  TRUE
## skewness_roll_dumbbell    1.000000    2.14020528   FALSE FALSE
## skewness_pitch_dumbbell   1.000000    2.14748489   FALSE FALSE
## skewness_yaw_dumbbell     0.000000    0.00727961    TRUE  TRUE
## max_roll_dumbbell         1.000000    1.90725777   FALSE FALSE
## max_picth_dumbbell        1.000000    1.87085972   FALSE FALSE
## max_yaw_dumbbell          1.142857    0.45133581   FALSE FALSE
## min_roll_dumbbell         1.000000    1.80534323   FALSE FALSE
## min_pitch_dumbbell        1.666667    1.92909660   FALSE FALSE
## min_yaw_dumbbell          1.142857    0.45133581   FALSE FALSE
## amplitude_roll_dumbbell   6.000000    2.07468880   FALSE FALSE
## amplitude_pitch_dumbbell  6.000000    2.05284997   FALSE FALSE
## amplitude_yaw_dumbbell   98.000000    0.01455922   FALSE  TRUE
## total_accel_dumbbell      1.050515    0.30574361   FALSE FALSE
## var_accel_dumbbell       14.000000    2.06740919   FALSE FALSE
## avg_roll_dumbbell         1.000000    2.12564607   FALSE FALSE
## stddev_roll_dumbbell     12.000000    2.08196841   FALSE FALSE
## var_roll_dumbbell        12.000000    2.08196841   FALSE FALSE
## avg_pitch_dumbbell        1.000000    2.12564607   FALSE FALSE
## stddev_pitch_dumbbell    12.000000    2.08196841   FALSE FALSE
## var_pitch_dumbbell       12.000000    2.08196841   FALSE FALSE
## avg_yaw_dumbbell          1.000000    2.12564607   FALSE FALSE
## stddev_yaw_dumbbell      12.000000    2.08196841   FALSE FALSE
## var_yaw_dumbbell         12.000000    2.08196841   FALSE FALSE
## gyros_dumbbell_x          1.044084    1.68158987   FALSE FALSE
## gyros_dumbbell_y          1.281174    1.96549465   FALSE FALSE
## gyros_dumbbell_z          1.037209    1.41952391   FALSE FALSE
## accel_dumbbell_x          1.029536    2.97736041   FALSE FALSE
## accel_dumbbell_y          1.142857    3.29766325   FALSE FALSE
## accel_dumbbell_z          1.011561    2.91184393   FALSE FALSE
## magnet_dumbbell_x         1.016807    7.77462328   FALSE FALSE
## magnet_dumbbell_y         1.283186    5.99111888   FALSE FALSE
## magnet_dumbbell_z         1.092308    4.84094053   FALSE FALSE
## roll_forearm             11.666667   13.62742957   FALSE FALSE
## pitch_forearm            62.674419   19.18905147   FALSE FALSE
## yaw_forearm              14.966667   12.89218898   FALSE FALSE
## kurtosis_roll_forearm    36.500000    1.63063260   FALSE  TRUE
## kurtosis_picth_forearm   74.000000    1.63063260   FALSE  TRUE
## kurtosis_yaw_forearm      0.000000    0.00727961    TRUE  TRUE
## skewness_roll_forearm    72.000000    1.64519182   FALSE  TRUE
## skewness_pitch_forearm   18.500000    1.60151416   FALSE FALSE
## skewness_yaw_forearm      0.000000    0.00727961    TRUE  TRUE
## max_roll_forearm         24.000000    1.44864235   FALSE  TRUE
## max_picth_forearm         4.500000    0.90995123   FALSE FALSE
## max_yaw_forearm           3.476190    0.29118439   FALSE FALSE
## min_roll_forearm         24.000000    1.46320157   FALSE  TRUE
## min_pitch_forearm         3.272727    0.93179006   FALSE FALSE
## min_yaw_forearm           3.476190    0.29118439   FALSE FALSE
## amplitude_roll_forearm   24.000000    1.54327728   FALSE  TRUE
## amplitude_pitch_forearm   4.352941    1.02642498   FALSE FALSE
## amplitude_yaw_forearm     3.068493    0.01455922   FALSE FALSE
## total_accel_forearm       1.125428    0.49501347   FALSE FALSE
## var_accel_forearm         4.000000    2.14020528   FALSE FALSE
## avg_roll_forearm         72.000000    1.64519182   FALSE  TRUE
## stddev_roll_forearm      74.000000    1.63063260   FALSE  TRUE
## var_roll_forearm         74.000000    1.63063260   FALSE  TRUE
## avg_pitch_forearm        72.000000    1.64519182   FALSE  TRUE
## stddev_pitch_forearm     72.000000    1.64519182   FALSE  TRUE
## var_pitch_forearm        72.000000    1.64519182   FALSE  TRUE
## avg_yaw_forearm          72.000000    1.64519182   FALSE  TRUE
## stddev_yaw_forearm       74.000000    1.63063260   FALSE  TRUE
## var_yaw_forearm          74.000000    1.63063260   FALSE  TRUE
## gyros_forearm_x           1.107438    2.03829075   FALSE FALSE
## gyros_forearm_y           1.095420    5.19764141   FALSE FALSE
## gyros_forearm_z           1.104348    2.11836646   FALSE FALSE
## accel_forearm_x           1.030769    5.68537526   FALSE FALSE
## accel_forearm_y           1.171429    7.11945840   FALSE FALSE
## accel_forearm_z           1.035714    4.10569993   FALSE FALSE
## magnet_forearm_x          1.050000   10.59183228   FALSE FALSE
## magnet_forearm_y          1.310345   13.25616947   FALSE FALSE
## magnet_forearm_z          1.023256   11.70561258   FALSE FALSE
## classe                    1.469526    0.03639805   FALSE FALSE</code></pre>
<p>Get all the near zero variables and remove them from all the datasets</p>
<pre><code>allnzvInData &lt;-names(myTrain) %in% row.names(nearZeroMetrics)[nearZeroMetrics$nzv]
myTrain &lt;- myTrain[,!allnzvInData]
myTest &lt;- myTest[,!allnzvInData]
total_test &lt;- total_test[,!allnzvInData]
dim(myTrain)</code></pre>
<pre><code>## [1] 13737   122</code></pre>
<p>After removing all the fields that have a near zero variabnce, remove the user id’s so that the don’t affect the outcome of the machine learning algorithms</p>
<pre><code>myTrain &lt;- myTrain[,-1]
myTest &lt;- myTest[,-1]
total_test &lt;- total_test[,-1]</code></pre>
<p>We can remove the columns that are mostly NA’s. In my case I used a threshold of 70% (i.e) I removed the columns whose values are about 70% NA’s.</p>
<pre><code>remove_columns &lt;- function(dataset){
  newDataset &lt;- dataset
  for(i in 1:ncol(dataset)){
    if(sum(is.na(dataset[,i]))/nrow(dataset) &gt;= 0.70){
      newDataset &lt;- newDataset[,-which(names(newDataset)==names(dataset)[i])]
    }
  }
  newDataset
}
myTrain &lt;- remove_columns(dataset = myTrain)
myTest &lt;- remove_columns(dataset = myTest)
total_test &lt;- remove_columns(dataset = total_test)
dim(myTrain)</code></pre>
<pre><code>## [1] 13737    58</code></pre>
</div>

<div id="different-machine-learning-models">
<h3>
<a id="4-different-machine-learning-models" class="anchor" href="#4-different-machine-learning-models" aria-hidden="true"><span class="octicon octicon-link"></span></a>4. Different Machine Learning Models</h3>
<p>The code to fit the given data into a decision tree is as shown below</p>
<pre><code>#Decision Tree
model1 &lt;- rpart(classe~.,data=myTrain,method="class")
#Plot the generated Tree
fancyRpartPlot(model1)</code></pre>
<p><img title alt width="672"></p>
<pre><code>#Boosting W/ Trees
model2 &lt;- train(classe~.,data = myTrain,method = "gbm", verbose=FALSE)
#Random Forests
model3 &lt;- randomForest(classe~.,data = myTrain)
#Naive Bayes Algorithm
model4 &lt;- train(classe~.,data=myTrain,method="nb")</code></pre>
</div>

<div id="confusion-matrices">
<h3>
<a id="5-confusion-matrices" class="anchor" href="#5-confusion-matrices" aria-hidden="true"><span class="octicon octicon-link"></span></a>5. Confusion Matrices</h3>
<pre><code>#Confusion matrix for Decision Tree
cf1 &lt;- confusionMatrix(myTest$classe,predict(model1,myTest[,-58],type="class"))
#Confusion matrix for Boosting W/ Tree
cf2 &lt;- confusionMatrix(myTest$classe,predict(model2,myTest[,-58]))
#Confusion matrix for Random Forest
cf3 &lt;- confusionMatrix(myTest$classe,predict(model3,myTest[,-58]))
#Confusion matrix for Naive Bayes Classification
cf4 &lt;- confusionMatrix(myTest$classe,predict(model4,myTest[,-58]))</code></pre>
</div>

<div id="accuracy-of-various-machine-learning-algorithms">
<h3>
<a id="6-accuracy-of-various-machine-learning-algorithms" class="anchor" href="#6-accuracy-of-various-machine-learning-algorithms" aria-hidden="true"><span class="octicon octicon-link"></span></a>6. Accuracy of various Machine Learning Algorithms</h3>
<pre><code>accuracy_analysis &lt;- data.frame(
  "models" = c("Decision Tree","Boosting W/ Trees","Random Forest","Naive Bayes"),
  "accuracy" = c(cf1$overall[1]*100,cf2$overall[1]*100,cf3$overall[1]*100,cf4$overall[1]*100))
accuracy_analysis</code></pre>
<pre><code>##              models accuracy
## 1     Decision Tree 86.96686
## 2 Boosting W/ Trees 99.76211
## 3     Random Forest 99.91504
## 4       Naive Bayes 78.47069</code></pre>
<p>Based on the accuracies of all the fitted models, random forest has a better accuracy.</p>
</div>

<div id="generating-output-files">
<h3>
<a id="7-generating-output-files" class="anchor" href="#7-generating-output-files" aria-hidden="true"><span class="octicon octicon-link"></span></a>7. Generating output files</h3>
<pre><code>#I had issues with the column classes between the test and training sets and therefore I used this function for conversion
ConvertColumnClasses &lt;- function(trainingSet, testingSet){
  for(i in 1:ncol(testingSet)){
    class(testingSet[,i]) &lt;- class(trainingSet[,i])
  }
}
#The function call changes the column classes
ConvertColumnClasses(trainingSet = myTrain[,-58],testingSet = total_test[,-58])
total_test &lt;- rbind(myTrain[3,-58],total_test[,-58])
total_test &lt;- total_test[-3,]
#Code for generation
pml_write_files = function(path,x){
  n = length(x)
  for(i in 1:n){
    filename = paste0(path,"/","problem_id_",i,".txt")
    write.table(x[i],file=filename,quote=FALSE,row.names=FALSE,col.names=FALSE)
  }
}
dir.create("test_cases")
answers = rep("A", 20)
predictions &lt;- predict(model3,total_test,type="class")
pml_write_files(path = "test_cases",x = predictions)</code></pre>
</div>

<p></p>
</div>
</div>

<p></p>
</div>







<p>
</p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/ashwintk/PracticalMachineLearning">Practicalmachinelearning</a> is maintained by <a href="https://github.com/ashwintk">ashwintk</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>

